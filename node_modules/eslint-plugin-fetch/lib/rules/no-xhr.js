'use strict';

/**
 * @fileoverview Prevent XMLHttpRequest
 * @author Jeff Dolle
 */

module.exports = function (context) {

  return {
    NewExpression: function NewExpression(node) {
      if (node.callee.name === 'XMLHttpRequest') {
        context.report({
          node: node,
          message: 'You should use \'fetch\' instead of \'new XMLHttpRequest\''
        });
      } else if (node.callee.name === 'ActiveXObject') {
        var argument = node.arguments[0].value;

        switch (argument) {
          case 'Microsoft.XMLHTTP':
          case 'Msxml2.XMLHTTP':
            context.report({
              node: node,
              message: 'You should use \'fetch\' instead of \'new ActiveXObject(\'' + argument + '\')\''
            });
            break;
          default:
        }
      }
    }
  };
};

module.exports.schema = [];